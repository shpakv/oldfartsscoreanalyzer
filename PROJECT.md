# Oldfarts CS2 Stats Project

> ะกะธััะตะผะฐ ะฐะฝะฐะปะธะทะฐ CS2 ะปะพะณะพะฒ ั ัะฐััะตัะพะผ ะฟัะพะดะฒะธะฝัััั ัะตะนัะธะฝะณะพะฒ ะธะณัะพะบะพะฒ (EPI) ะธ ะณะตะฝะตัะฐัะธะตะน ะธะฝัะตัะฐะบัะธะฒะฝัั HTML ะพััะตัะพะฒ

## ะกะพะดะตัะถะฐะฝะธะต
- [ะงัะพ ะดะตะปะฐะตั ะฟัะพะตะบั](#ััะพ-ะดะตะปะฐะตั-ะฟัะพะตะบั)
- [ะััะธัะตะบัััะฐ ะธ Data Flow](#ะฐััะธัะตะบัััะฐ-ะธ-data-flow)
- [ะกัััะบัััะฐ ะบะพะดะฐ](#ััััะบัััะฐ-ะบะพะดะฐ)
- [ะะปััะตะฒัะต ะบะพะผะฟะพะฝะตะฝัั](#ะบะปััะตะฒัะต-ะบะพะผะฟะพะฝะตะฝัั)
- [ะคะพัะผัะปะฐ EPI ะธ ะฑะฐะนะตัะพะฒัะบะธะน ัะตะนัะธะฝะณ](#ัะพัะผัะปะฐ-epi-ะธ-ะฑะฐะนะตัะพะฒัะบะธะน-ัะตะนัะธะฝะณ)
- [ะขะตะบััะฐั ัะฐะทัะฐะฑะพัะบะฐ (feat/games)](#ัะตะบััะฐั-ัะฐะทัะฐะฑะพัะบะฐ-featgames)
- [ะัััััะน ััะฐัั](#ะฑัััััะน-ััะฐัั)
- [ะะฐะฒะธัะธะผะพััะธ](#ะทะฐะฒะธัะธะผะพััะธ)
- [ะะฐะถะฝัะต ะดะตัะฐะปะธ ัะตะฐะปะธะทะฐัะธะธ](#ะฒะฐะถะฝัะต-ะดะตัะฐะปะธ-ัะตะฐะปะธะทะฐัะธะธ)

---

## ะงัะพ ะดะตะปะฐะตั ะฟัะพะตะบั

**Oldfarts** โ ััะพ Go-ะฟัะธะปะพะถะตะฝะธะต ะดะปั ะฟะฐััะธะฝะณะฐ ะธ ะฐะฝะฐะปะธะทะฐ CS2 (Counter-Strike 2) ัะตัะฒะตัะฝัั ะปะพะณะพะฒ.

**ะัะฝะพะฒะฝัะต ะฒะพะทะผะพะถะฝะพััะธ:**
1. **ะะฐััะธะฝะณ CS2 ะปะพะณะพะฒ** โ ะธะทะฒะปะตัะตะฝะธะต ัะพะฑััะธะน ัะฑะธะนััะฒ, ัะปะตัะตะบ, ะดะตัััะทะฐ, ัะฐัะฝะดะพะฒ ะธะท ัะฐะนะปะพะฒ ะปะพะณะพะฒ
2. **ะะฐััะตั EPI ัะตะนัะธะฝะณะพะฒ** โ ัะปะพะถะฝะฐั ัะพัะผัะปะฐ ะพัะตะฝะบะธ ัััะตะบัะธะฒะฝะพััะธ ะธะณัะพะบะฐ ั ััะตัะพะผ ะบะพะฝัะตะบััะฐ ะฑะพั
3. **ะะฐะนะตัะพะฒัะบะฐั ัะตะณัะปััะธะทะฐัะธั** โ ัะฟัะฐะฒะตะดะปะธะฒะฐั ะพัะตะฝะบะฐ ะธะณัะพะบะพะฒ ั ัะฐะทะฝัะผ ะบะพะปะธัะตััะฒะพะผ ััะณัะฐะฝะฝัั ัะฐัะฝะดะพะฒ
4. **ะะตะฝะตัะฐัะธั HTML ะพััะตัะฐ** โ ะธะฝัะตัะฐะบัะธะฒะฝัะน single-page HTML ั ะผะฐััะธัะฐะผะธ, ะณัะฐัะธะบะฐะผะธ, ัะฐะฑะฐะผะธ
5. **ะคะธะปัััะฐัะธั ะฟะพ ะดะฐัะฐะผ** โ ะดะธะฝะฐะผะธัะตัะบะธะน ะฟะตัะตััะตั ััะฐัะธััะธะบะธ ะฝะฐ ะบะปะธะตะฝัะต
6. **ะญะบัะฟะพัั ะฒ CSV** โ ะพะฟัะธะพะฝะฐะปัะฝะฐั ะฒัะณััะทะบะฐ ะผะฐััะธัั ัะฑะธะนััะฒ

**ะัะพะณะพะฒัะน ัะฐะนะป:** `cs2_stats.html` โ ัะฐะผะพะดะพััะฐัะพัะฝัะน HTML ั inline CSS/JS (~6MB ั ะดะฐะฝะฝัะผะธ)

---

## ะััะธัะตะบัััะฐ ะธ Data Flow

```
โโโโโโโโโโโโโโโโโ
โ  CS2 Logs     โ  ะกะตัะฒะตัะฝัะต ะปะพะณะธ (*.log ัะฐะนะปั)
โ  /logs/       โ
โโโโโโโโโฌโโโโโโโโ
        โ
        โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  1. PARSER (internal/logparser)           โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ     โ
โ  โข ะกะบะฐะฝะธัะพะฒะฐะฝะธะต ะดะธัะตะบัะพัะธะธ ัะตะบัััะธะฒะฝะพ    โ
โ  โข Regex ะธะทะฒะปะตัะตะฝะธะต ัะพะฑััะธะน:              โ
โ    - KillEvent (killer, victim, weapon)   โ
โ    - FlashEvent (flasher, victim, time)   โ
โ    - DefuseEvent (player, kit, result)    โ
โ    - RoundStats (JSON ะฑะปะพะบะธ)              โ
โ  โข ะะพะธัะบ ะณัะฐะฝะธั ะผะฐััะตะน (Match_Start โ     โ
โ    Game Over)                             โ
โ  โข ะะฐััะตั EPI ะดะปั ะบะฐะถะดะพะณะพ ัะฐัะฝะดะฐ          โ
โ  โข ะะฟัะตะดะตะปะตะฝะธะต ะฟะพะฑะตะดะธัะตะปั ัะฐัะฝะดะฐ          โ
โโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
            โ
            โผ
    โโโโโโโโโโโโโโโโโ
    โ  ParseResult  โ  ะัะพะผะตะถััะพัะฝะฐั ััััะบัััะฐ
    โโโโโโโโโฌโโโโโโโโ
            โ
            โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  2. PROCESSOR (internal/stats)            โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ     โ
โ  โข ะััะฟะฟะธัะพะฒะบะฐ ะธะณัะพะบะพะฒ (ะฟะพ SteamID/nick)  โ
โ  โข ะะพัััะพะตะฝะธะต ะผะฐััะธั:                     โ
โ    - KillMatrix (ะบัะพ ะบะพะณะพ ัะฑะธะป)           โ
โ    - WeaponData (ะบัะพ ั ัะตะณะพ ัะฑะธะฒะฐะตั)      โ
โ    - FlashData (ะบัะพ ะบะพะณะพ ัะปะตัะธะป)          โ
โ    - DefuseData (ััะฐัะธััะธะบะฐ ะดะตัััะทะฐ)      โ
โ  โข ะะณัะตะณะฐัะธั ัะตะนัะธะฝะณะพะฒ:                   โ
โ    - ะกัะผะผะฐ EPI ะฟะพ ัะฐัะฝะดะฐะผ                 โ
โ    - ะะฐะนะตัะพะฒัะบะธะน ัะตะนัะธะฝะณ (K=100)          โ
โ    - ะะฐััะตั ฮผ (ััะตะดะฝะธะน EPI ะฒัะตั ะธะณัะพะบะพะฒ)  โ
โ  โข ะััะฟะฟะธัะพะฒะบะฐ ัะพะฑััะธะน ะฟะพ ะดะฐัะฐะผ           โ
โโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
            โ
            โผ
    โโโโโโโโโโโโโโโโโ
    โ  StatsData    โ  ะะพัะพะฒะฐั ััะฐัะธััะธะบะฐ
    โโโโโโโโโฌโโโโโโโโ
            โ
            โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  3. GENERATOR (internal/output)           โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ     โ
โ  โข ะะพะผะฟะพะฝะตะฝัะฝะฐั ะฐััะธัะตะบัััะฐ:              โ
โ    - KillsTab (ะผะฐััะธัะฐ ัะฑะธะนััะฒ)           โ
โ    - WeaponsTab (ััะฐัะธััะธะบะฐ ะพััะถะธั)       โ
โ    - FlashTab (ััะฐัะธััะธะบะฐ ัะปะตัะตะบ)         โ
โ    - PlayerRatingsTab (ัะตะนัะธะฝะณ ะธะณัะพะบะพะฒ)   โ
โ    - RoundsTab (ะดะตัะฐะปะธ ัะฐัะฝะดะพะฒ) [NEW]    โ
โ    - DefuseTab (ััะฐัะธััะธะบะฐ ะดะตัััะทะฐ)       โ
โ  โข ะะตะฝะตัะฐัะธั inline CSS                   โ
โ  โข ะะตะฝะตัะฐัะธั JS ั embedded JSON data      โ
โ  โข ะะฝัะตัะฐะบัะธะฒะฝะพััั: ัะพััะธัะพะฒะบะฐ,           โ
โ    ัะธะปัััะฐัะธั, drag&drop                  โ
โโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
            โ
            โผ
    โโโโโโโโโโโโโโโโโ
    โ cs2_stats.htmlโ  ะคะธะฝะฐะปัะฝัะน HTML ะพััะตั
    โโโโโโโโโโโโโโโโโ
```

---

## ะกัััะบัััะฐ ะบะพะดะฐ

```
oldfarts/
โโโ cmd/
โ   โโโ logs/stats/main.go       # Entry point ะดะปั ััะฐัะธััะธะบะธ ะปะพะณะพะฒ
โ   โโโ teambuildercli/main.go   # CLI ะดะปั ะฑะธะปะดะธะฝะณะฐ ะบะพะผะฐะฝะด (ะดััะณะพะน ะฟัะพะตะบั)
โ
โโโ internal/
โ   โโโ logparser/               # ะะฐััะธะฝะณ CS2 ะปะพะณะพะฒ
โ   โ   โโโ parser.go           # ะัะฝะพะฒะฝะฐั ะปะพะณะธะบะฐ ะฟะฐััะธะฝะณะฐ
โ   โ   โโโ types.go            # Event ััััะบัััั (Kill, Flash, Defuse, RoundStats)
โ   โ
โ   โโโ stats/                   # ะะฑัะฐะฑะพัะบะฐ ััะฐัะธััะธะบะธ
โ   โ   โโโ processor.go        # ะะพัััะพะตะฝะธะต ะผะฐััะธั ะธ ะฐะณัะตะณะฐัะธั
โ   โ   โโโ types.go            # StatsData, PlayerRating, Matrices
โ   โ
โ   โโโ components/              # HTML ะบะพะผะฟะพะฝะตะฝัั ะดะปั ัะฐะฑะพะฒ
โ   โ   โโโ kills.go            # ะขะฐะฑ "ะกะพััะฝ, ะฑัะฐัะฐะฝ" (ะผะฐััะธัะฐ ัะฑะธะนััะฒ)
โ   โ   โโโ weapons.go          # ะขะฐะฑั ะพััะถะธั (ะบัะพ ั ัะตะณะพ/ะบะพะณะพ ัะตะผ)
โ   โ   โโโ flash.go            # ะขะฐะฑ "ะะฝะดะตะบั ะะธัะพะณะฐ" (ัะปะตัะบะธ)
โ   โ   โโโ playerratings.go    # ะขะฐะฑ "ะะตะนัะธะฝะณ ะธะณัะพะบะพะฒ" [NEW]
โ   โ   โโโ rounds.go           # ะขะฐะฑ "ะะณัั" (ะดะตัะฐะปะธ ัะฐัะฝะดะพะฒ) [NEW]
โ   โ   โโโ defuse.go           # ะขะฐะฑ "ะะตัะพะธ ะะตัััะทะฐ"
โ   โ   โโโ ratings.go          # (DEPRECATED, ะทะฐะผะตะฝะตะฝ ะฝะฐ playerratings.go)
โ   โ
โ   โโโ output/                  # ะะตะฝะตัะฐัะธั ะฒััะพะดะฝัั ัะฐะนะปะพะฒ
โ       โโโ html.go             # ะัะฝะพะฒะฝะพะน HTML ะณะตะฝะตัะฐัะพั
โ       โโโ csv.go              # CSV ัะบัะฟะพัั ะผะฐััะธัั ัะฑะธะนััะฒ
โ
โโโ logs/                        # ะะธัะตะบัะพัะธั ั CS2 ะปะพะณะฐะผะธ (ะฟะพ ัะผะพะปัะฐะฝะธั)
โโโ cs2_stats.html              # ะกะณะตะฝะตัะธัะพะฒะฐะฝะฝัะน HTML ะพััะตั
โโโ RATING_SYSTEM.md            # ะะพะดัะพะฑะฝะพะต ะพะฟะธัะฐะฝะธะต ัะพัะผัะปั EPI
โโโ PROJECT.md                  # ะญัะพั ัะฐะนะป
โโโ go.mod                      # Go ะทะฐะฒะธัะธะผะพััะธ
```

---

## ะะปััะตะฒัะต ะบะพะผะฟะพะฝะตะฝัั

### 1. **LogParser** (`internal/logparser`)

**ะะฐะดะฐัะฐ:** ะะทะฒะปะตัั ััััะบัััะธัะพะฒะฐะฝะฝัะต ัะพะฑััะธั ะธะท ัะตะบััะพะฒัั ะปะพะณะพะฒ CS2.

**ะัะฝะพะฒะฝัะต ััััะบัััั:**
- `KillEvent` โ ัะฑะธะนััะฒะพ (killer, victim, weapon, date)
- `FlashEvent` โ ะพัะปะตะฟะปะตะฝะธะต ัะปะตัะบะพะน (flasher, victim, duration, date)
- `DefuseEvent` โ ัะพะฑััะธั ะดะตัััะทะฐ (player, withKit, eventType, date)
- `RoundStats` โ ะฟะพะปะฝะฐั ััะฐัะธััะธะบะฐ ัะฐัะฝะดะฐ (ะธะท JSON_BEGIN ะฑะปะพะบะพะฒ):
  - Metadata: ะดะฐัะฐ, ะฒัะตะผั, ะฝะพะผะตั ัะฐัะฝะดะฐ, ััะตั, ะบะฐััะฐ, ัะตัะฒะตั
  - Players: ะผะฐััะธะฒ `PlayerStats` ั ะดะตัะฐะปัะฝะพะน ััะฐัะธััะธะบะพะน ะบะฐะถะดะพะณะพ ะธะณัะพะบะฐ
  - Winner: 2=T, 3=CT, 0=unknown

**ะะฐะถะฝัะต ะผะตัะพะดั:**
- `ParseDirectory(dir, ext)` โ ัะตะบัััะธะฒะฝัะน ะพะฑัะพะด ะดะธัะตะบัะพัะธะธ ั ะปะพะณะฐะผะธ
- `findMatchBounds(lines)` โ ะฟะพะธัะบ ะณัะฐะฝะธั ะผะฐััะตะน (Match_Start โ Game Over)
- `parseMatchLines(...)` โ ะฟะฐััะธะฝะณ ัะพะฑััะธะน ัะพะปัะบะพ ะฒะฝัััะธ ะผะฐััะตะน
- `parseJSONBlockFromLines(...)` โ ะธะทะฒะปะตัะตะฝะธะต RoundStats ะธะท JSON_BEGIN...JSON_END
- `calculateRoundRatings(round)` โ ัะฐััะตั EPI ะดะปั ะฒัะตั ะธะณัะพะบะพะฒ ะฒ ัะฐัะฝะดะต

**Regex ะฟะฐััะตัะฝั:**
```go
// ะัะธะผะตั: "player<4><[U:1:123]><CT>" killed "victim<5><[U:1:456]><T>" with "ak47"
KillPattern: `"([^"<]+)<\d+><([^>]+)><[^>]*>"\s+\[...\]\s+killed\s+"([^"<]+)<\d+><([^>]+)><[^>]*>"\s+\[...\]\s+with\s+"([^"]+)"`

// ะัะธะผะตั: "victim<4><[U:1:123]><T>" blinded for 2.45 by "flasher<5><[U:1:456]><CT>"
FlashPattern: `"([^"<]+)<\d+><([^>]+)><[^>]*>"\s+blinded\s+for\s+([0-9.]+)\s+by\s+"([^"<]+)<\d+><([^>]+)><[^>]*>"`
```

**ะะฐััะตั EPI ะฒ ะฟะฐััะตัะต:**
```go
// ะคะพัะผัะปะฐ EPI (ะฒะฝัััะธ calculateRoundRatings):
damageImpact := (dmg/100.0) * pow(5.0/oppCount, 0.7) * pow(oppCount/teamCount, 0.5)
fragImpact := 0.15*kills + 0.08*assists
numerator := damageImpact + fragImpact
denominator := 1.0 + 0.35*deaths
baseRating := numerator / denominator
winBonus := 1.0 + 0.10*win
finalRating := baseRating * winBonus
```

---

### 2. **Processor** (`internal/stats`)

**ะะฐะดะฐัะฐ:** ะัะตะพะฑัะฐะทะพะฒะฐัั ัะพะฑััะธั ะฒ ััะฐัะธััะธัะตัะบะธะต ััััะบัััั ะธ ัะฐัััะธัะฐัั ัะตะนัะธะฝะณะธ.

**ะัะฝะพะฒะฝะพะน ะผะตัะพะด:** `Process(parseResult, groupBy) โ StatsData`

**ะงัะพ ะดะตะปะฐะตั:**
1. **ะััะฟะฟะธัะพะฒะบะฐ ะธะณัะพะบะพะฒ:**
   - ะะพ `steamid`: ะบะปัั = `[U:1:123]`, ะทะฐะณะพะปะพะฒะพะบ = nickname
   - ะะพ `name`: ะบะปัั = nickname, ะทะฐะณะพะปะพะฒะพะบ = nickname
2. **ะะพัััะพะตะฝะธะต ะผะฐััะธั:**
   - `KillMatrix` โ NรN (ะบัะพ ะบะพะณะพ ัะบะพะปัะบะพ ัะฐะท ัะฑะธะป)
   - `WeaponData` โ PlayersรWeapons (ะบัะพ ั ัะตะณะพ ัะฑะธะฒะฐะตั/ะบะพะณะพ ัะตะผ ัะฑะธะฒะฐัั)
   - `FlashData` โ NรN (ะบัะพ ะบะพะณะพ ัะปะตัะธะป: count + seconds)
   - `DefuseData` โ ะผะฐััะธะฒ ััะฐัะธััะธะบะธ ะฟะพ ะดะตัััะทั ะดะปั ะบะฐะถะดะพะณะพ ะธะณัะพะบะฐ
3. **ะะณัะตะณะฐัะธั ัะตะนัะธะฝะณะพะฒ:**
   - `buildPlayerRatings(roundStats, ...)` โ ะฐะณัะตะณะธััะตั EPI ะฟะพ ัะฐัะฝะดะฐะผ
   - ะะปั ะบะฐะถะดะพะณะพ ะธะณัะพะบะฐ:
     - `RoundsPlayed` โ ะบะพะปะธัะตััะฒะพ ัะฐัะฝะดะพะฒ
     - `TotalEPI` โ ััะผะผะฐ EPI
     - `AverageEPI` โ ะฟัะพััะพะต ััะตะดะฝะตะต
     - `BayesianEPI` โ ะฑะฐะนะตัะพะฒัะบะธะน ัะตะนัะธะฝะณ
4. **ะััะฟะฟะธัะพะฒะบะฐ ะฟะพ ะดะฐัะฐะผ:**
   - `DailyKills`, `DailyFlash`, `DailyDefuse`, `DailyRounds` โ ะผะฐะฟะฟะธะฝะณ ะดะฐัะฐ โ ัะพะฑััะธั

**ะะฐะนะตัะพะฒัะบะธะน ัะตะนัะธะฝะณ:**
```go
const K = 100.0 // ะะธะฝะธะผะฐะปัะฝะพะต ะบะพะปะธัะตััะฒะพ ัะฐัะฝะดะพะฒ ะดะปั ะดะพััะพะฒะตัะฝะพััะธ

// ะะฐััะตั ััะตะดะฝะตะณะพ EPI ะฒัะตั ะธะณัะพะบะพะฒ (ฮผ)
mu := totalEPI / totalRounds

// ะะฐะนะตัะพะฒัะบะธะน ัะตะนัะธะฝะณ ะดะปั ะบะฐะถะดะพะณะพ ะธะณัะพะบะฐ
BayesianEPI = (TotalEPI + K*mu) / (RoundsPlayed + K)
```

**ะกะผััะป:** ะะพะฒะธัะบะธ ั ะผะฐะปัะผ ะบะพะปะธัะตััะฒะพะผ ัะฐัะฝะดะพะฒ "ะฟัะธััะณะธะฒะฐัััั" ะบ ััะตะดะฝะตะผั ะทะฝะฐัะตะฝะธั ฮผ. ะะฟััะฝัะต ะธะณัะพะบะธ ั 100+ ัะฐัะฝะดะพะฒ ะธะผะตัั ัะตะนัะธะฝะณ ะฑะปะธะทะบะธะน ะบ ะธั ัะตะฐะปัะฝะพะผั ััะตะดะฝะตะผั.

---

### 3. **Output Generator** (`internal/output`)

**ะะฐะดะฐัะฐ:** ะะตะฝะตัะธัะพะฒะฐัั ะธะฝัะตัะฐะบัะธะฒะฝัะน HTML ะพััะตั.

**ะััะธัะตะบัััะฐ ะบะพะผะฟะพะฝะตะฝัะพะฒ:**
```go
type HTMLGenerator struct {
    killsTab         *components.KillsTabComponent
    weaponsTab       *components.WeaponsTabComponent
    flashTab         *components.FlashTabComponent
    defuseTab        *components.DefuseTabComponent
    roundsTab        *components.RoundsTabComponent          // [NEW]
    playerRatingsTab *components.PlayerRatingsTabComponent  // [NEW]
}
```

ะะฐะถะดัะน ะบะพะผะฟะพะฝะตะฝั ะธะผะตะตั:
- `GenerateHTML()` โ string โ HTML ััััะบัััะฐ ัะฐะฑะฐ
- `GenerateJS(data)` โ string โ JS ะบะพะด ะดะปั ัะตะฝะดะตัะธะฝะณะฐ ะธ ะธะฝัะตัะฐะบัะธะฒะฝะพััะธ

**ะะปััะตะฒัะต ะพัะพะฑะตะฝะฝะพััะธ HTML:**
1. **Single-page architecture** โ ะฒัะต ะฒ ะพะดะฝะพะผ ัะฐะนะปะต
2. **Inline CSS** โ dark theme, CSS Grid, sticky headers
3. **Embedded JSON data** โ ะฒัะต ัะพะฑััะธั ะธ ััะฐัะธััะธะบะฐ ะฒัะธัั ะฒ JS ะฟะตัะตะผะตะฝะฝัะต
4. **Client-side ัะธะปัััะฐัะธั** โ ะฟะตัะตััะตั ััะฐัะธััะธะบะธ ะฟัะธ ะธะทะผะตะฝะตะฝะธะธ ะดะฐั
5. **ะะฝัะตัะฐะบัะธะฒะฝัะต ะผะฐััะธัั:**
   - ะกะพััะธัะพะฒะบะฐ ะฟะพ ะบะปะธะบั ะฝะฐ ะทะฐะณะพะปะพะฒะพะบ
   - Drag & Drop ะดะปั ะฟะตัะตัะฟะพััะดะพัะธะฒะฐะฝะธั
   - Heatmap ัะฐัะบัะฐัะบะฐ
   - Search ัะธะปััั
   - CSV ัะบัะฟะพัั
6. **Hash-based routing** โ `#sorrybro`, `#ratings`, `#games` ะธ ั.ะด.

**JS Data Flow:**
```javascript
// Embedded data
PLAYERS = ["player1", "player2", ...]
WEAPONS = ["ak47", "m4a1", ...]
DAILY_KILLS = {"2025-01-15": [...], "2025-01-16": [...]}
DAILY_ROUNDS = {"2025-01-15": [...], "2025-01-16": [...]}

// Date filter
DATE_FROM = "2025-01-01"
DATE_TO = "2025-01-31"

// ะคะธะปัััะฐัะธั ัะพะฑััะธะน
filteredKillEvents = getFilteredEvents(DAILY_KILLS)
filteredRoundStats = getFilteredEvents(DAILY_ROUNDS)

// ะะตัะตััะตั ัะตะนัะธะฝะณะพะฒ ะฝะฐ ะบะปะธะตะฝัะต
playerRatingsTabState.calculateRatings(filteredRoundStats)
```

---

## ะคะพัะผัะปะฐ EPI ะธ ะฑะฐะนะตัะพะฒัะบะธะน ัะตะนัะธะฝะณ

**EPI (Effective Performance Index)** โ ะผะตััะธะบะฐ ัััะตะบัะธะฒะฝะพััะธ ะธะณัะพะบะฐ ะฒ ัะฐัะฝะดะต.

**ะัะฐัะบะฐั ัะพัะผัะปะฐ:**
```
EPI = [(ะฃัะพะฝ ร ะะพััะตะบัะธะธ) + (ะฃะฑะธะนััะฒะฐ ร 0.15) + (ะััะธััั ร 0.08)] / (1 + ะกะผะตััะธ ร 0.35) ร (1 + ะะพะฑะตะดะฐ ร 0.10)
```

**ะะพััะตะบัะธะธ ััะพะฝะฐ:**
1. **ะะฐะทะพะฒัะน ััะพะฝ:** `ะฃัะพะฝ / 100` (100 HP = 1 ััะปะพะฒะฝะพะต ัะฑะธะนััะฒะพ)
2. **ะะพััะตะบัะธั ะฝะฐ ะบะพะปะธัะตััะฒะพ ะฒัะฐะณะพะฒ:** `(5 / ะัะพัะธะฒะฝะธะบะพะฒ)^0.7` โ ัะตะผ ะผะตะฝััะต ะฒัะฐะณะพะฒ, ัะตะผ ัะปะพะถะฝะตะต ะฝะฐะฝะตััะธ ััะพะฝ
3. **ะะพััะตะบัะธั ะฝะฐ ัะธัะปะตะฝะฝะพะต ะฟัะตะธะผััะตััะฒะพ:** `(ะัะพัะธะฒะฝะธะบะพะฒ / ะกะพัะทะฝะธะบะพะฒ)^0.5` โ ะธะณัะฐัั ะฒ ะผะตะฝััะธะฝััะฒะต ัะปะพะถะฝะตะต

**ะะฐะนะตัะพะฒัะบะธะน ัะตะนัะธะฝะณ:**
```
BayesianEPI = (ฮฃE + Kรฮผ) / (N + K)

ะณะดะต:
  ฮฃE โ ััะผะผะฐ EPI ะฟะพ ะฒัะตะผ ัะฐัะฝะดะฐะผ ะธะณัะพะบะฐ
  N  โ ะบะพะปะธัะตััะฒะพ ััะณัะฐะฝะฝัั ัะฐัะฝะดะพะฒ
  K  โ ะบะพะฝััะฐะฝัะฐ (100 ัะฐัะฝะดะพะฒ) โ "ะฒะตั" ะฒะธัััะฐะปัะฝัั ัะฐัะฝะดะพะฒ
  ฮผ  โ ััะตะดะฝะธะน EPI ะฒัะตั ะธะณัะพะบะพะฒ (~0.6)
```

**ะะฝัะตัะฟัะตัะฐัะธั:**
- `< 0.4` โ ะฝะธะถะต ััะตะดะฝะตะณะพ
- `0.4 - 0.6` โ ััะตะดะฝะธะน ััะพะฒะตะฝั
- `0.6 - 0.8` โ ัะพัะพัะธะน ะธะณัะพะบ
- `0.8 - 1.0` โ ะพัะตะฝั ัะธะปัะฝัะน ะธะณัะพะบ
- `> 1.0` โ ัะพะฟ ะธะณัะพะบ

**ะะพะดัะพะฑะฝะพะต ะพะฑัััะฝะตะฝะธะต:** ัะผ. `RATING_SYSTEM.md` (26kb ัะตะบััะฐ ั ะฟัะธะผะตัะฐะผะธ)

---

## ะขะตะบััะฐั ัะฐะทัะฐะฑะพัะบะฐ (feat/games)

**ะะตัะบะฐ:** `feat/games`

**ะัะฝะพะฒะฝัะต ะธะทะผะตะฝะตะฝะธั:**
1. โ **ะะพะฑะฐะฒะปะตะฝ ัะฐะฑ "ะะณัั" (RoundsTab)**
   - ะะตัะฐะปัะฝัะน ะฟัะพัะผะพัั ะบะฐะถะดะพะณะพ ัะฐัะฝะดะฐ
   - ะะพะบะฐะทัะฒะฐะตั ัะพััะฐะฒ ะบะพะผะฐะฝะด, ััะตั, EPI ะบะฐะถะดะพะณะพ ะธะณัะพะบะฐ
   - ะคะธะปััััะตััั ะฟะพ ะดะฐัะฐะผ
   - ะคะฐะนะป: `internal/components/rounds.go` (+516 lines)

2. โ **ะะตัะฐะบัะพัะธะฝะณ ัะฐะฑะฐ "ะะตะนัะธะฝะณ ะธะณัะพะบะพะฒ" (PlayerRatingsTab)**
   - ะะตัะตะฝะตัะตะฝ ะธะท `ratings.go` ะฒ `playerratings.go`
   - ะะพะฑะฐะฒะปะตะฝะพ warning ะพะบะฝะพ "ะะะะะะะะ! ะะพะถะตั ะฝะฐะฒัะตะดะธัั ะฒะฐัะตะผั ัะณะพ" ๐
   - ะะพะบะฐะทัะฒะฐะตั: ัะตะนัะธะฝะณ, ััะตะดะฝะธะน EPI, K/D/A, ััะพะฝ, Win%, ะฟะพัะปะตะดะฝัั ะธะณัะฐ
   - ะฆะฒะตัะพะฒะฐั ะธะฝะดะธะบะฐัะธั: ะบัะฐัะฝัะน/ะพัะฐะฝะถะตะฒัะน/ัะธะฝะธะน/ะทะตะปะตะฝัะน
   - ะัะตะดัะฟัะตะถะดะตะฝะธะต "โ ะฝะตะดะพััะฐัะพัะฝะพ ะดะฐะฝะฝัั" ะดะปั ะธะณัะพะบะพะฒ ั < 100 ัะฐัะฝะดะพะฒ
   - ะคะฐะนะป: `internal/components/playerratings.go` (+274 lines)

3. โ **Hash-based routing**
   - URL ัะตัะธ ะดะปั ัะฐะฑะพะฒ: `#sorrybro`, `#ratings`, `#games` ะธ ั.ะด.
   - ะะฐะฑะพัะฐัั ะบะฝะพะฟะบะธ ะฝะฐะทะฐะด/ะฒะฟะตัะตะด ะฑัะฐัะทะตัะฐ
   - ะะฒัะพะผะฐัะธัะตัะบะธะน ัะธะปััั ะฟะพ ัะตะบััะตะผั ะผะตัััั ะดะปั ัะฐะฑะฐ "ะกะพััะฝ, ะฑัะฐัะฐะฝ"

4. โ **ะะฟัะธะผะธะทะฐัะธั ัะธะปัััะฐัะธะธ**
   - ะกะพะฑััะธั ะณััะฟะฟะธัััััั ะฟะพ ะดะฐัะฐะผ: `DailyKills`, `DailyFlash`, `DailyDefuse`, `DailyRounds`
   - ะะตัะตััะตั ะฝะฐ ะบะปะธะตะฝัะต ัะตัะตะท event `dateFilterChanged`

5. โ **ะฃะปัััะตะฝะธั UX**
   - ะะพะปะพัะฐั ะฟะพะดัะฒะตัะบะฐ ะฒัะดะตะปะตะฝะฝะพะณะพ ะธะณัะพะบะฐ ะฒ ะผะฐััะธัะต ัะฑะธะนััะฒ
   - ะะฐะณััะทะพัะฝัะน ะธะฝะดะธะบะฐัะพั ั ะฟะพัะฐะณะพะฒัะผ ะฟัะพะณัะตััะพะผ
   - ะกะพััะธัะพะฒะบะฐ ะฟะพ ะผะฐะบัะธะผะฐะปัะฝะพะผั ะทะฝะฐัะตะฝะธั ะฒ ะผะฐััะธัะต

**ะกัะฐัะธััะธะบะฐ ะธะทะผะตะฝะตะฝะธะน:**
```
14 files changed, 1097 insertions(+), 139 deletions(-)

ะะพะฒัะต ัะฐะนะปั:
+ internal/components/playerratings.go (+274 lines)
+ internal/components/rounds.go (+516 lines)

ะััะฟะฝัะต ะธะทะผะตะฝะตะฝะธั:
  internal/output/html.go (+298 lines)
  internal/stats/processor.go (+35 lines)
  internal/stats/types.go (+26 lines)

ะฃะดะฐะปะตะฝะพ:
- internal/components/ratings.go (-28 lines)
```

---

## ะัััััะน ััะฐัั

### ะกะฑะพัะบะฐ ะธ ะทะฐะฟััะบ

```bash
# 1. ะกะฑะพัะบะฐ ะฑะธะฝะฐัะฝะธะบะฐ
go build -o stats cmd/logs/stats/main.go

# 2. ะะฐะฟััะบ ั ะปะพะณะฐะผะธ ะฒ ะฟะฐะฟะบะต logs/
./stats

# 3. ะะฐะฟััะบ ั custom ะฟะฐัะฐะผะตััะฐะผะธ
./stats -dir=/path/to/logs -ext=.log -html=output.html

# 4. ะัะบัััั HTML ะฒ ะฑัะฐัะทะตัะต
open cs2_stats.html
```

### ะคะปะฐะณะธ

```
-dir string
    ะะฐะฟะบะฐ ั ะปะพะณะฐะผะธ (ัะตะบัััะธะฒะฝะพ) (default "logs")

-ext string
    ะคะธะปััั ะฟะพ ัะฐััะธัะตะฝะธั (ะฝะฐะฟัะธะผะตั, .log). ะัััะพ = ะฒัะต ัะฐะนะปั

-by string
    ะััะฟะฟะธัะพะฒะบะฐ ะธะณัะพะบะพะฒ: name|steamid (default "steamid")

-out string
    ะกะพััะฐะฝะธัั CSV ะดะปั ะผะฐััะธัั ัะฑะธะนััะฒ (ะพะฟัะธะพะฝะฐะปัะฝะพ)

-html string
    ะััั ะบ HTML (ะฒัะตะณะดะฐ ะฟะธัะตััั) (default "cs2_stats.html")

-highlight string
    ะะณัะพะบ ะดะปั ะทะพะปะพัะพะน ะฟะพะดัะฒะตัะบะธ ะฒ ัะฐะฑะต "ะกะพััะฝ, ะัะฐัะฐะฝ" (default "Mr. Titspervert")
```

### ะัะธะผะตั

```bash
# ะะฝะฐะปะธะท ะปะพะณะพะฒ ะทะฐ ะพะบััะฑัั ั ัะบัะฟะพััะพะผ CSV
./stats \
  -dir=logs \
  -ext=.log \
  -by=steamid \
  -out=kills_matrix.csv \
  -html=october_stats.html \
  -highlight="YourNickname"
```

---

## ะะฐะฒะธัะธะผะพััะธ

```go
require (
    github.com/aws/aws-sdk-go-v2 v1.39.2
    github.com/aws/aws-sdk-go-v2/config v1.31.12
    github.com/aws/aws-sdk-go-v2/service/dynamodb v1.51.0
    github.com/google/uuid v1.6.0
    github.com/stretchr/testify v1.11.1
)
```

**ะัะธะผะตัะฐะฝะธะต:** AWS SDK ะธัะฟะพะปัะทัะตััั ะดะปั ะดััะณะพะน ัะฐััะธ ะฟัะพะตะบัะฐ (team builder), ะฝะต ะดะปั ััะฐัะธััะธะบะธ ะปะพะณะพะฒ.

---

## ะะฐะถะฝัะต ะดะตัะฐะปะธ ัะตะฐะปะธะทะฐัะธะธ

### 1. ะะพะธัะบ ะณัะฐะฝะธั ะผะฐััะตะน

ะะพะณะธ CS2 ะผะพะณัั ัะพะดะตัะถะฐัั ะฝะตัะบะพะปัะบะพ ะผะฐััะตะน ะฒ ะพะดะฝะพะผ ัะฐะนะปะต. Parser ะธัะตั:
- **ะะฐัะฐะปะพ ะผะฐััะฐ:** `World triggered "Match_Start" on "map_name"`
- **ะะพะฝะตั ะผะฐััะฐ:** `Game Over: competitive map_name score X:Y after Z min`

ะะฐัััััั ัะพะปัะบะพ ัะพะฑััะธั **ะฒะฝัััะธ** ััะธั ะณัะฐะฝะธั.

### 2. JSON_BEGIN ะฑะปะพะบะธ

CS2 ะทะฐะฟะธััะฒะฐะตั ะฟะพะดัะพะฑะฝัั ััะฐัะธััะธะบั ัะฐัะฝะดะฐ ะฒ ัะฟะตัะธะฐะปัะฝัั ะฑะปะพะบะฐั:
```
L 09/05/2025 - 18:11:25: JSON_BEGIN{
L 09/05/2025 - 18:11:25: "round_number" : "1"
L 09/05/2025 - 18:11:25: "score_t" : "0"
L 09/05/2025 - 18:11:25: "score_ct" : "0"
L 09/05/2025 - 18:11:25: "map" : "de_dust2"
L 09/05/2025 - 18:11:25: "player_0" : "26840160,2,16000,0,0,0,0,0.00,0.00,0,0,..."
L 09/05/2025 - 18:11:25: JSON_END
```

Parser ะธะทะฒะปะตะบะฐะตั metadata ะธ CSV-ะดะฐะฝะฝัะต ะธะณัะพะบะพะฒ (27 ะฟะพะปะตะน).

### 3. ะะฐััะตั Winner ัะฐัะฝะดะฐ

Winner ะพะฟัะตะดะตะปัะตััั ะฟะพ ัะพะฑััะธัะผ:
- `Team "CT" triggered "SFUI_Notice_CTs_Win"` โ Winner = 3
- `Team "TERRORIST" triggered "SFUI_Notice_Terrorists_Win"` โ Winner = 2

ะญัะฐ ะธะฝัะพัะผะฐัะธั ะธัะฟะพะปัะทัะตััั ะดะปั:
- ะะพะฝััะฐ ะฟะพะฑะตะดั ะฒ ัะพัะผัะปะต EPI (+10%)
- ะะพะดััะตัะฐ WinRate ะธะณัะพะบะพะฒ

### 4. AccountID vs SteamID

- **SteamID format:** `[U:1:26840160]` (ะธะท ะปะพะณะพะฒ)
- **AccountID:** `26840160` (ัะธัะปะพะฒะฐั ัะฐััั)

ะะตะนัะธะฝะณะธ ะฐะณัะตะณะธัััััั ะฟะพ AccountID, ะธะผะตะฝะฐ ัะตะทะพะปะฒัััั ะธะท ัะพะฑััะธะน.

### 5. Client-side ะฟะตัะตััะตั

ะัะธ ะธะทะผะตะฝะตะฝะธะธ ัะธะปัััะฐ ะดะฐั:
1. ะกะพะฑััะธั ัะธะปัััััััั: `getFilteredEvents(DAILY_KILLS, DATE_FROM, DATE_TO)`
2. ะะฐััะธัั ะฟะตัะตััะธััะฒะฐัััั ั ะฝัะปั
3. ะะตะนัะธะฝะณะธ ะฟะตัะตััะธััะฒะฐัััั ัะตัะตะท `calculateRatings(filteredRoundStats)`
4. Event `dateFilterChanged` ััะธะณะณะตัะธั ะฟะตัะตัะธัะพะฒะบั ะฒัะตั ัะฐะฑะพะฒ

**ะะปัั:** ะะณะฝะพะฒะตะฝะฝัะน ะฟะตัะตััะตั ะฑะตะท ะฟะตัะตะณะตะฝะตัะฐัะธะธ HTML
**ะะธะฝัั:** ะะพะปััะพะน ัะฐะทะผะตั ัะฐะนะปะฐ (~6MB) โ ะฒัะต ัะพะฑััะธั embedded

### 6. Heatmap ัะฐัะบัะฐัะบะฐ

ะฆะฒะตั ััะตะนะบะธ ะทะฐะฒะธัะธั ะพั ะพัะฝะพัะตะฝะธั `value / maxValue`:
```javascript
const ratio = value / maxValue
const r = Math.floor(255 * Math.min(1, ratio * 2))
const g = Math.floor(255 * Math.max(0, 1 - ratio))
const b = 50
const color = `rgb(${r}, ${g}, ${b})`
```

ะะตะทัะปััะฐั: ะพั ะทะตะปะตะฝะพะณะพ (0) ะดะพ ะบัะฐัะฝะพะณะพ (max).

### 7. Drag & Drop ะฟะตัะตัะฟะพััะดะพัะธะฒะฐะฝะธะต

ะะฐะณะพะปะพะฒะบะธ ัะฐะฑะปะธั ะธะผะตัั `draggable=true`. ะัะธ drop:
```javascript
function dropCol(e) {
  const from = draggedColIndex
  const to = parseInt(e.target.dataset.col)
  orderCols.splice(from, 1)
  orderCols.splice(to, 0, draggedColIndex)
  draw()
}
```

ะะพะทะฒะพะปัะตั ะฒัััะฝัั ะฟะตัะตัะฟะพััะดะพัะธะฒะฐัั ัััะพะบะธ/ััะพะปะฑัั.

### 8. Git ะฒะตััะธั ะฒ ัััะตัะต

```go
func getBuildVersion() string {
    now := time.Now().Format("2006-01-02 15:04:05")
    cmd := exec.Command("git", "rev-parse", "--short", "HEAD")
    output, _ := cmd.Output()
    gitHash := strings.TrimSpace(string(output))
    return now + " โข " + gitHash
}
```

ะัะพะฑัะฐะถะฐะตััั ะฒ ัััะตัะต: `ะกะฑะพัะบะฐ: 2025-01-15 12:34:56 โข abc1234`

---

## ะะพะปะตะทะฝัะต ะบะพะผะฐะฝะดั

```bash
# ะกะฑะพัะบะฐ ะธ ะทะฐะฟััะบ ะฒ ะพะดะฝั ะบะพะผะฐะฝะดั
go run cmd/logs/stats/main.go -dir=logs -html=cs2_stats.html

# ะะพัะผะพััะตัั ััะฐัะธััะธะบั ะฟะพ ะปะพะณะฐะผ
find logs -name "*.log" | xargs wc -l

# ะะฐะฟัััะธัั ั profile (ะตัะปะธ ะฝัะถะฝะฐ ะพะฟัะธะผะธะทะฐัะธั)
go run cmd/logs/stats/main.go -cpuprofile=cpu.prof

# ะัะบัััั HTML ััะฐะทั ะฟะพัะปะต ะณะตะฝะตัะฐัะธะธ (macOS)
./stats && open cs2_stats.html

# Grep ะฟะพ ัะพะฑััะธัะผ ะฒ ะปะพะณะฐั
grep "killed" logs/*.log | wc -l     # ะะพะปะธัะตััะฒะพ ัะฑะธะนััะฒ
grep "blinded" logs/*.log | wc -l    # ะะพะปะธัะตััะฒะพ ัะปะตัะตะบ
grep "JSON_BEGIN" logs/*.log | wc -l # ะะพะปะธัะตััะฒะพ ัะฐัะฝะดะพะฒ
```

---

## Roadmap ะธ ะธะดะตะธ

### ะขะตะบััะธะต ะทะฐะดะฐัะธ (feat/games)
- [x] ะะพะฑะฐะฒะธัั ัะฐะฑ "ะะณัั" (Rounds)
- [x] ะะตัะฐะบัะพัะธะฝะณ ัะตะนัะธะฝะณะพะฒ ะธะณัะพะบะพะฒ
- [x] Hash-based routing
- [ ] ะะตัะฐะปัะฝัะน ะฟัะพัะผะพัั ะบะพะฝะบัะตัะฝะพะณะพ ัะฐัะฝะดะฐ (ะผะพะดะฐะป ะพะบะฝะพ?)
- [ ] ะัะฐัะธะบะธ EPI ะฟะพ ะฒัะตะผะตะฝะธ (chart.js?)

### ะัะดััะธะต ัะปัััะตะฝะธั
- [ ] Websocket ะดะปั live ะพะฑะฝะพะฒะปะตะฝะธะน (ะฟัะธ ะฐะบัะธะฒะฝะพะน ะธะณัะต)
- [ ] ะกัะฐะฒะฝะตะฝะธะต ะดะฒัั ะฟะตัะธะพะดะพะฒ (ะดะพ/ะฟะพัะปะต, ะผะตััั ะบ ะผะตัััั)
- [ ] ะญะบัะฟะพัั ะฒัะตั ัะฐะฑะพะฒ ะฒ PDF
- [ ] ะะพะฑะธะปัะฝะฐั ะฐะดะฐะฟัะฐัะธั (responsive design)
- [ ] Team balance suggestions (ะฝะฐ ะพัะฝะพะฒะต EPI)
- [ ] ะะฝัะตะณัะฐัะธั ั Steam API (ะฐะฒะฐัะฐัั, ัะฐะฝะณะธ)

---

## ะะพะฝัะฐะบัั ะธ ัััะปะบะธ

- **Git ัะตะฟะพะทะธัะพัะธะน:** `feat/games` ะฒะตัะบะฐ (ัะตะบััะฐั)
- **Main ะฒะตัะบะฐ:** ััะฐะฑะธะปัะฝะฐั ะฒะตััะธั ะฑะตะท ัะฐะฑะฐ "ะะณัั"
- **ะะตัะฐะปะธ ัะพัะผัะปั:** `RATING_SYSTEM.md` (26kb)
- **ะะพะณะธ:** `logs/` ะดะธัะตะบัะพัะธั (ะฝะต ะฒ git)
- **Output:** `cs2_stats.html` (ะฝะต ะฒ git, ~6MB)

---

**ะะฒัะพั:** Oldfarts Team
**ะะตััะธั:** feat/games (build: 2025-01-27)
**Go ะฒะตััะธั:** 1.24+